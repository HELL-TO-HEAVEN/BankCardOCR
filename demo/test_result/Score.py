import os

img_blank_card = ['0010_33713267', '4033_9100_2568_2801', '4367_4200_1111_0836_598', '4392_6251_0654_1164', '4581_2359_1848_6268', '4581_2421_9328_5688', '4673_0979_6445_7133', '621067_6802117806233', '6210981000025440761', '6210985840040311158', '621226_0200008855948', '621226_0200010022032', '621226_0200060414659', '6214623928000244913', '6214_8301_7367_2642', '6214_8301_8047_0568', '6214_8301_9679_8796', '6216615300012069511', '621785_2000011952028', '6217995960000992632', '6217_0000_1003_0385_457', '6217_0011_2000_1832_855', '6217_0020_0002_2732_699', '6221881000091096321', '622262_0910021194091', '622262_0910026146336', '622262_0910034736458', '6222_3701_1372_3858', '6222_3702_3891_3004', '6225_7631_0005_4633', '6225_7675_1283_1876', '6225_7683_1858_4115', '6226_0901_0890_6526', '6226_5521_6701_8345', '6226_6302_0134_0782', '6226_6604_0164_5334', '6226_8801_7902_6828', '622700_078_265_0696376', '622848_0018086936079', '622848_0018254325972', '622848_0405639408179', '622848_0470564149818', '623052_1250001138575', '6230_8101_0095_4693', '623516_0006700691719', '6253_6340_0706_2521', '6258_0816_5383_4842', '6259_0621_1863_9124', '6259_6560_7056_4053', '6360_9495_4062_5653']
img_base_card =  ['001033713267', '4033910025682801', '4367420011110836598', '4392625106541164', '4581235918486268', '4581242193285688', '4673097964457133', '6210676802117806233', '6210981000025440761', '6210985840040311158', '6212260200008855948', '6212260200010022032', '6212260200060414659', '6214623928000244913', '6214830173672642', '6214830180470568', '6214830196798796', '6216615300012069511', '6217852000011952028', '6217995960000992632', '6217000010030385457', '6217001120001832855', '6217002000022732699', '6221881000091096321', '6222620910021194091', '6222620910026146336', '6222620910034736458', '6222370113723858', '6222370238913004', '6225763100054633', '6225767512831876', '6225768318584115', '6226090108906526', '6226552167018345', '6226630201340782', '6226660401645334', '6226880179026828', '6227000782650696376', '6228480018086936079', '6228480018254325972', '6228480405639408179', '6228480470564149818', '6230521250001138575', '6230810100954693', '6235160006700691719', '6253634007062521', '6258081653834842', '6259062118639124', '6259656070564053', '6360949540625653']
detected_num = 0
correct_base_card_num = 0
correct_blank_card_num = 0
correct_base_card_list = []
correct_blank_card_list = []


base_path=r'./'
file_list=os.listdir(base_path)
print('当前目录文件列表：{}'.format(file_list))

#find result.txt
for file in file_list:
    if file == 'result.txt' or file == 'results.txt':
        cur_path = os.getcwd()
        result_path = os.path.join(cur_path, file)
        print('result.txt文件目录：{}'.format(result_path))

#calculate data
with open(result_path, 'r') as f:
    lines = f.readlines()
    for line in lines:
        line = line.strip().replace('\n', '').replace('：', ':').replace(',', ':').replace('，', ',')
        if ':' in line:
            detected_num += 1
            base_card = line.split(':')[1].replace(' ','').replace('_','')
            blank_card = line.split(':')[1].replace(' ','_')
            if base_card in img_base_card:
                correct_base_card_num += 1
                correct_base_card_list.append(base_card)
                if blank_card in img_blank_card:
                    correct_blank_card_num += 1
                    correct_blank_card_list.append(blank_card)
acc = correct_base_card_num / detected_num
score = correct_base_card_num*0.8 + correct_blank_card_num*0.2

if detected_num !=0 :
    print('检测数量：{}，已检测到卡片正确率：{}，正确识别卡片数：{}， 检测到成功识别空格的卡片数：{}， 最终得分：{} '.format(detected_num, acc, correct_base_card_num,correct_blank_card_num, score))
elif detected_num == 0:
    print('计算异常，请检测程序与result.txt格式！')
input('按任意键退出')
